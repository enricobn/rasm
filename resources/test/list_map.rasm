include "std.rasm"

enum List<T> {
  Full(head: T, tail: List<T>),
  Empty
}

nPrintList(listMap(List::Full(10, List::Full(20, List::Empty())), { v -> nadd(v, 15);}));

fn nPrintList(l: List<T>) {
    ListMatch(l, { head,tail -> nprint(head); ListMatch(tail, { head1,tail1 -> sprint(",");}, { -> }); nPrintList(tail);}, { -> });
}

fn listMap(l: List<T>, map: fn(T) -> T) -> List<T> {
    ListMatch(l, { head,tail -> List::Full(map(head), listMap(tail, map)); }, { -> List::Empty();});
}
