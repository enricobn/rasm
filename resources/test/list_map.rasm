include "std.rasm"

enum List<T> {
  Full(head: T, tail: List<T>),
  Empty
}

listApply(listMap(List::Full(10, List::Full(20, List::Empty())), { v -> nadd(v, 15);}), { v -> nprint(v);});

fn listApply(l: List<T>, apply: fn(T) -> ()) {
    ListMatch(l, { head,tail -> apply(head); ListMatch(tail, { head1,tail1 -> sprint(",");}, { -> }); listApply(tail, apply);}, { -> });
}

fn listMap(l: List<T>, map: fn(T) -> T) -> List<T> {
    ListMatch(l, { head,tail -> List::Full(map(head), listMap(tail, map)); }, { -> List::Empty();});
}
